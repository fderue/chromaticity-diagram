<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chromaticity Diagram</title>

    <!-- style -->
    <link rel="stylesheet" href="css/styles.css" />

    <!-- librairies -->
    <script>
      window.MathJax = {
        loader: { load: ["[tex]/color"] },
      };
    </script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
    ></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/3.3.0/math.min.js"></script>
    <script
      src="https://cdn.plot.ly/plotly-2.35.2.min.js"
      charset="utf-8"
    ></script>

    <!-- script -->
    <script type="module" src="js/anim-patch-color-match.js"></script>
    <script type="module" src="js/anim-spd.js"></script>
    <script type="module" src="js/anim-cmexp.js"></script>
    <script type="module" src="js/anim-cmf.js"></script>
    <script type="module" src="js/anim-tristimulus.js"></script>
    <script type="module" src="js/anim-cmf2graph3d.js"></script>
  </head>
  <body>
    <h1>Chromaticity Diagram</h1>
    <div class="image-container">
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/ba/PlanckianLocus.png/1200px-PlanckianLocus.png"
        alt="chromaticity diagram"
      />
    </div>
    <h2>Introduction. Why am I interested in this diagram?</h2>

    <p>
      As a photography enthusiast, I wanted to invest in a high-quality monitor
      for photo editing. Naturally, I turned to Google and searched for
      <i>Best monitor for photo editing</i>. I assumed that the most important
      factor for photography was a monitor that could accurately reproduce
      colors as they appear in real life. But which specifications truly matter?
      I had often come across the term <i>color gamut coverage</i>, but I never
      fully understood it. Specifications like <i>98% sRGB</i> or
      <i>95% AdobeRGB</i> appeared frequently, and while it was clear that
      higher percentages were better, I wanted to dive deeper. What do these
      values actually represent? When researching color gamut, sRGB, and
      AdobeRGB, I repeatedly encountered this diagram, called the
      <span class="highlight">CIE 1931 xy-chromaticity diagram</span>.
    </p>
    <p>
      Determined to finally demystify this diagram, I embarked on an in-depth
      investigation. This article is the result of my findings. By the end,
      you'll be able to answer these questions:
    </p>
    <ul>
      <li>What is the chromaticity diagram?</li>
      <li>What is it used for?</li>
      <li>Where does it come from?</li>
      <li>How was it created?</li>
    </ul>
    Let's dive in!

    <h3>The short story</h3>

    <p>
      What is a chromaticity diagram? I would quickly describe the chromaticity
      diagram as a representation of the
      <span class="highlight">Human Visual Gamut</span>, the full range of
      colors that the human eye can perceive. But then you would ask me: all the
      colors? but I don't see the grey? neither the brown nor the burgundy? and
      why would a color have a (x, y) coordinate? Does it mean you could
      represent mathematically a color? Then I would try to be more specific:
      Consider that a color could be fully characterized by two attributes: its
      <span class="highlight">chromaticity</span> and its
      <span class="highlight">luminance</span>. The chromaticity diagram
      represents <i>only</i> the chromaticity of the Human Visual Gamut,
      ignoring luminance. For example, the white point in this diagram has a
      chromaticity of (x = 0.33, y = 0.33), but its luminance isn't represented.
    </p>
    <p>
      If this short explanation does not satisfy you, I invite you to keep
      reading and start by asking yourself a simple question: what is a color?
    </p>

    <h2>What is a color? Color vs Wavelength</h2>

    <p>
      You've probably learned in physics class that light is an electromagnetic
      wave, and the portion visible to the human eye falls within the wavelength
      range of approximately 380 nm to 750 nm. You've likely seen a diagram
      illustrating this visible spectrum, where violet appears at the shortest
      wavelengths (~380 nm) and red at the longest (~750 nm).
    </p>
    <div class="image-container">
      <img
        src="https://www.datacolor.com/wp-content/uploads/2024/01/electromagnetic-spectrum.jpg"
        alt="visible spectrum"
      />
    </div>
    <p>
      Each wavelength in this range seems to correspond to a specific color. But
      here's an interesting question: Does this mean that every color we
      perceive can be produced by an electromagnetic wave with a specific
      wavelength? In other words, if you could generate a light with
      electromagnetic waves at any wavelength and any intensity, would you find
      one that corresponds to pink? Let's test this idea with a simple
      simulation. Try matching those patch colors:
    </p>
    <div id="anim-patch-color-match"></div>
    <p>
      Not possible right? That brings us to an important conclusion: not every
      color we perceive can be produced by a light of a single wavelength. A
      light composed of a single wavelength is called
      <span class="highlight">monochromatic light</span> . The colors produced
      by monochromatic light belong to a group known as the
      <span class="highlight"> spectral colors</span>. But what happens when we
      mix multiple monochromatic lights? We get
      <span class="highlight">polychromatic light</span>. And this is how we get
      the other colors.
    </p>
    <p>
      A perfect example is sunlight, which is a polychromatic light made up of
      all the wavelengths in the visible spectrum. You've probably seen this in
      action with a prism experiment, where white light is split into the
      different spectral colors.
    </p>
    <div class="image-container">
      <img
        src="https://pbs.twimg.com/media/E_UA_azVIAAj1Ae.jpg"
        alt="a prism decomposes sunlight into its spectral colors"
      />
    </div>
    <h3>Spectral Power Distribution (SPD)</h3>
    <p>
      Now, imagine we have a device—similar to a prism that not only decomposes
      light into its individual monochromatic components but also measures the
      amount of energy carried by each wavelength. Good news: such a tool
      exists, and it's called a
      <span class="highlight">spectrometer</span>! The spectrometer's measures
      allows to create a graph known as the
      <span class="highlight">Spectral Power Distribution (SPD)</span>, which
      shows the <span class="highlight">flux density Φ(λ) [W/nm]</span> at each
      wavelength. Here are some exemple of SPD.
    </p>
    <div id="anim-spd"></div>
    <p>
      We might imagine that to create a color from its SPD, we could combine all
      the monochromatic lights of the visible spectrum, adjusting their
      intensities according to the SPD. However, this approach is impractical
      for two main reasons: first, pure monochromatic light does not truly
      exist, and second, we would need an infinite number of such lights. There
      must be an easier way!
    </p>
    <p>
      Let's take a classical color as the yellow. As seen in the visual
      spectrum, it seems to correspond to the spectral color at about 575nm. But
      you've also known your whole life that you could mix red and green to get
      yellow. So it seems we could create yellow in two different ways:
    </p>
    <ol>
      <li>Using a monochromatic light at 575nm.</li>
      <li>
        Combining two monochromatic lights: a red one at 650nm and a green one
        at 545nm.
      </li>
    </ol>
    <p>
      On the graph below, you can visualize the SPD of the the monochromatic
      light yellow being a peak at 575nm and the SPD of the combined red and
      green having a peak at 650 and 545 nm.
    </p>
    <div id="anim-spd-yellow"></div>
    <p>
      So two different SPD but the same color! At this point, you might wonder
      🤔: "Maybe it's not two different SPD because if we mix two wavelengths,
      it could create a single monochromatic wavelength that corresponds to
      their sum?" Not quite! For one, wavelengths don't add up like numbers: if
      you recall some trigonometry, adding two sinusoidal waves doesn't simply
      result in another sine wave of their summed wavelength. Plus, even if you
      wanted to add the wavelength of the green and red, it would not give the
      wavelength of yellow (545nm(green) + 650nm(red) ≠ 575nm(yellow)).
    </p>
    <p>
      This brings us to an important concept: light of different SPD can have
      the same color! This phenomenon is called
      <span class="highlight">Metamerism</span>. Metamerism is the phenomenon
      where two different light sources, with different SPDs, are perceived as
      the same color by the human eye. Perhaps, instead of defining color based
      on the physical properties of light, we should focus more on how the human
      eye perceives it.
    </p>
    <h3>Trichromatic Vision</h3>
    <p>
      In the early 1800s, Thomas Young proposed a groundbreaking idea: the human
      eye has <span class="highlight">three types of receptors</span>, each
      sensitive to a different range of wavelengths—corresponding roughly to
      red, green, and blue light. This meant that color perception is determined
      by how these receptors respond to incoming light. Yes, you've guessed it,
      these receptors are what we now call <span class="highlight">cones</span>!
      Since different light spectra can produce the same cone response, this
      explains metamerism, why different SPDs can result in the same perceived
      color. In a few words,
    </p>
    <div id="color-definition">A color is a specific cone response.</div>
    <p>
      As a qualitative example of cone response, imagine looking at blue light.
      The first and second types of cones would show low sensitivity, while the
      third type would have high sensitivity. Later, you'll see that we can
      represent cone responses as a triplet of number, for example, a blue light
      might be expressed quantitatively as (0.1, 0.1, 0.9).
    </p>
    <p>
      This was purely based on experiments at the time—scientists in the 1800s
      had no way to physically analyze the eye's cells. But in the 1960s,
      technology finally caught up. Using microspectrophotometry, a technique
      that measures the light absorption of individual cells, researchers
      confirmed the existence of three distinct types of cones:
    </p>
    <ul>
      <li>L-cones (sensitive to long wavelengths, red-sensitive)</li>
      <li>M-cones (sensitive too medium wavelengths, green-sensitive)</li>
      <li>S-cones (sensitive to short wavelengths, blue-sensitive)</li>
    </ul>
    <p>This discovery provided definitive proof of trichromatic vision!</p>
    <p>
      If we can determine the full range of possible cone responses, this range
      corresponds to the complete set of colors humans can perceive, also known
      as the Human Visual Gamut. Yes, this is the same gamut we mentioned at the
      start of this article! Remember, we're working toward explaining the
      chromaticity diagram, which represents the chromaticity attribute of each
      color of the Human Visual Gamut.
    </p>
    <p>
      But here's an important point: the CIE 1931 xy-chromaticity diagram, the
      very diagram we're trying to explain, was created in 1931, before
      scientists could directly measure cone sensitivity. So how did researchers
      determine cone responses and construct a representation of the Human
      Visual Gamut before they had the technology to analyze the eye's cells? To
      answer this, we need to step back into the 1920s, where two scientists,
      John Guild and William Wright, working independently, devised a similar
      way to map human color perception. Their key breakthrough came from an
      experiment known as the
      <span class="highlight">Color Matching Experiment</span>. In the next
      section, we'll break down this experiment and by the end, you'll
      understand key concepts such as: primaries, reference white, chromaticity,
      luminance, color matching functions.
    </p>

    <h2>The Color Matching Experiment</h2>
    <p>
      A natural conclusion of the trichromatic vision theory is that all
      perceivable colors can be created by mixing just three primary colors in
      varying proportions. The Color Matching Experiment was designed to
      determine how humans perceive color by recreating a
      <span class="highlight">test light</span>, a monochromatic light of
      varying wavelength, using a mix of three primary monochromatic lights,
      referred as <span class="highlight">primaries</span>. Here’s how it
      worked:
    </p>
    <ol>
      <li>A participant was shown a test light with a specific wavelength.</li>
      <li>
        They were given three primary lights of fixed wavelengths and asked to
        adjust their intensities until the mixed light matched the test light as
        closely as possible.
      </li>
      <li>
        This process was repeated for different test wavelengths across the
        visible spectrum.
      </li>
      <li>
        The experiment was conducted with multiple participants, and their
        results were recorded.
      </li>
    </ol>

    <h3>Calibration</h3>
    <p>
      Before conducting the actual Color Matching Experiment, the primaries
      needs to be calibrated using a white light, called a
      <span class="highlight">Reference White</span>. But we can't just pick any
      light that looks white, otherwise, others wouldn't be able to reproduce
      the experiment consistently. To ensure standardization, scientists use
      <span class="highlight">Standard Illuminants</span>, specific light
      sources defined by their SPD. These illuminants serve as reference white
      lights for color experiments. Some commonly used standard illuminants
      include:
    </p>
    <ul>
      <li>A: typical tungsten-filament light</li>
      <li>D65 (6500K): Approximating daylight</li>
      <li>E: a theoretical Equal-energy illuminant</li>
      <li>NPL: (National Physical Laboratory)</li>
    </ul>
    <div id="anim-spd-illuminant"></div>
    <p>
      What does calibration mean? Calibration is the process of adjusting the
      intensity of the primaries so that their combination matches the reference
      white. For example, at the start of the experiment, let's say that we can
      control the amount of light emitted by each primary by setting an amount
      of power in watt, then we could find that to match the reference white,
      the red primary needs to be set at 60W, the green primary at 30W, and the
      blue primary at 90W. It means that after calibration:
    </p>
    <ul>
      <li>One unit of red = 60W</li>
      <li>One unit of green = 30W</li>
      <li>One unit of blue = 90W</li>
    </ul>
    <p>
      Those units defines a new system to quantify an
      <span class="highlight">amount of primary</span>. Using this new unit
      system, we can say that the sum of one unit of each primary matches the
      reference white.
    </p>
    <p>
      You can try calibrating the primaries yourself using the animation below.
      Adjust each primary until it matches the reference white. Once you're
      satisfied, click <i>Calibrate</i>. The three calibrated values Rp, Gp, and
      Bp will appear. These notations will be used in the explanation later on.
    </p>
    <div id="anim-cmexp-calibration"></div>
    <p>
      Now that the system is calibrated, what we want to measure is the
      chromaticity of a color.
    </p>
    <h3>Chromaticity</h3>
    <p>
      In the color matching experiment, what matters is the amount of each
      primary required to match the test light set at a specific wavelength. At
      every wavelength, the participant was asked to change the intensity of
      each primary to match the test light, and the amount of each primary was
      recorded. Mathematically, we could represent this match as an equation
      called the color matching equation:
    </p>

    <div class="block-equation">
      $$\alpha C(\lambda) \triangleq r'(\lambda)\mathcal{R}
      \hat{+}g'(\lambda)\mathcal{G}\hat{+}b'(\lambda)\mathcal{B} $$
    </div>
    with
    <ul>
      <li>
        \(r'(\lambda), g'(\lambda), b'(\lambda)\) the amount of primary
        \(\mathcal{R},\mathcal{G},\mathcal{B}\) respectively.
      </li>
      <li>\(C(\lambda)\) the color to be matched.</li>
      <li>\(\alpha\) the amount of color \(C(\lambda)\)</li>
    </ul>
    <p>
      Those strange symbol \(\triangleq, \hat{+}\) indicates that they are not
      algebraic operations, but instead <i>physical</i> operations, such as the
      result of mixing light.
    </p>
    <p>
      Since there is no unit defined for \(C(\lambda)\), we don't know the
      amount \(\alpha\). But multiplying each side by a factor would actually
      keep the match. It is equivalent to increase the intensity of the test
      light and increase by the same amount each primary by a factor \(s\)
    </p>
    <div class="block-equation">
      $$ s\alpha C(\lambda) \triangleq \underbrace{sr'(\lambda)}_{r}\mathcal{R}
      \hat{+}\underbrace{sg'(\lambda)}_g\mathcal{G}\hat{+}\underbrace{sb'(\lambda)}_b\mathcal{B}
      $$
    </div>
    <p>
      Wright wanted to define the equation so that 1 unit of C would correspond
      to an equation where the sum of the coefficients \(r, g, b\) equal 1.
    </p>
    <div class="block-equation">
      $$ sr'+sg'+sr' = 1 \\ s = \frac{1}{r'+g'+b'} $$
    </div>
    <p>
      From this definition, the normalized coefficients \(r, g, b\) could be
      computed from the measured amount of primaries \(r', g', b’\).
    </p>
    <div class="block-equation">
      $$ \begin{split} r = \frac{r'}{r'+g'+b'}\\ g = \frac{g'}{r'+g'+b'}\\ b =
      \frac{b'}{r'+g'+b'} \end{split} $$
    </div>
    <p>The equation can be rewritten as</p>
    <div class="block-equation">
      $$ C(\lambda) \triangleq
      r(\lambda)\mathcal{R}\hat{+}g(\lambda)\mathcal{G}\hat{+}b(\lambda)\mathcal{B}
      $$
    </div>
    <p>
      meaning that 1 unit of color C is matched by \(r\) unit of Red, \(g\) unit
      of Green and \(b\) unit of Blue. Remember that \(r, g, b\) are not the
      initial amount found during the experiment, they are normalized value so
      that \(r+g+b = 1\). Those coefficients \((r, g, b)\), computed for each
      wavelength, are called the
      <span class="highlight">chromaticity coefficients</span>.
    </p>
    <div class="callout">
      Now I am going to show you quantitative results. Those are not directly
      the results from Guild and Wright, because they went through different
      iterations of their experience so their results changed along the way.
      Instead, I will show you directly the data that the Commission
      International de l'Éclairage (CIE) finally decided to use to make the
      standard. The primaries used are Red (700nm), Green (546.1nm) and Blue
      (435.8nm). The white reference is the the standard illuminant E.
    </div>
    <p>
      In the animation below, you can see these coefficients represented on a 2D
      graph. By hovering over it, you'll directly observe their relationship
      with the experiment. I've used the calibrated value \(R_c=60, G_c=30,
      B_b=90\) from the previous animation. You may notice that some spectral
      colors cannot be matched simply by mixing the three primaries. The only
      way to match them is by adding a <i>negative</i> amount of a primary
      color, which is equivalent to adding a positive amount on the test light
      side, as shown in the animation.
    </p>
    <div id="anim-cmexp"></div>
    <p>
      Now is the time to give a proper definition for chromaticity! As we saw
      earlier, the chromaticity coefficients represent the relative amounts of
      the primaries that, when summed, match a given color. Since these
      coefficients are relative, we can multiply them by the same factor and
      still obtain the same perceived color, but with a different intensity.
      Here, the word <i>color</i> can be misleading. One might argue that blue
      and dark blue are different colors, and that's fair! Instead, we can say:
      Blue and dark blue have different intensities but share the same
      chromaticity. In this context, <i>intensity</i> is a vague term. A more
      intuitive way to describe it might be <i>luminosity</i> or
      <i>brightness</i>, but the most precise term used in color science is
      <i>luminance</i>.We'll explore luminance in the next section but to
      conclude with the chromaticity, here is definition:
    </p>
    <div class="callout">
      The <span class="highlight">chromaticity</span> of a color is the relative
      amount of primaries needed to match a color regardless of its luminance.
      The relative amounts that sum up to one are called the chromaticity
      coefficients.
    </div>
    <p>
      The chromaticity is only one of the two attributes to describe a color.
      The other attribute is the luminance. To fully characterize a color, we
      need both. The chromaticity graph is not enough, we need another graph to
      take into consideration the luminance.
    </p>
    <h3>Luminance</h3>
    <p>
      The luminance describes how bright an object appears. The term luminance
      can be confusing because it has different meanings in photometry and
      radiometry:
    </p>
    <ul>
      <li>
        Photometric luminance is based on human vision and perception. It
        measures light as seen by the human eye and is expressed in lumens.
      </li>
      <li>
        Radiometric luminance, also called radiance, is a physical measurement
        of energy, independent of human perception. It is measured in watts per
        steradian per square meter (W/sr·m²).
      </li>
    </ul>
    <p>In this article, luminance refers to the photometric luminance.</p>
    <p>
      To illustrate the luminance, let's take a monochromatic red light and a
      monochromatic green light. If both emit the same power (let's say 1 watt),
      you might expect them to appear equally bright. But when you look at them,
      the green light appears brighter than the red, even though they emit the
      same amount of energy! This tells us that brightness is a relative
      metric—our eyes perceive some wavelengths as brighter than others, even
      when their physical energy output is identical. Imagine we have a
      monochromatic light source that emits exactly 1 watt of power at any given
      wavelength. Now, if we ask people to compare the brightness of different
      wavelengths, they will likely report that the brightest color they
      perceive is around 570 nm (yellow-green light). Since brightness is a
      relative measure, we can assign a value of 1 to this maximum perceived
      brightness and scale all other brightness perceptions accordingly. By
      gathering these observations across the entire visible spectrum, we obtain
      a curve known as the
      <span class="highlight">photopic luminosity function V(λ)</span>.
    </p>
    <div id="photopic-graph"></div>
    <p>
      This unit-less curve—derived from human-based experiments based on Wright
      and Guild works—illustrates how our eyes perceive brightness under
      well-lit conditions. So, how does luminance relate to the photopic curve?
    </p>
    <p>
      Luminance is computed based on the photopic function V(λ). Therefore, it
      remains a subjective measure—meaning it reflects human visual perception
      rather than an absolute physical quantity. However, unlike raw brightness
      perception, luminance has a unit and can be measured. Given a light source
      having a Spectral Power Distribution (SPD) \(\Phi(\lambda)\), its
      luminance is defined as:
    </p>
    <div class="block-equation">
      $$ L = C_l\int_\lambda \Phi(\lambda)V(\lambda) d\lambda $$
    </div>
    where
    <ul>
      <li>
        \(C_l=683.002\frac{\mathrm{lm}}{W}\) is a constant that ensures
        luminance is expressed in lumens.
      </li>
      <li>
        The integral sums the weighted contribution of each wavelength,
        according to the human eye's sensitivity V(λ).
      </li>
    </ul>
    <p>
      To simplify notation, I often omit the constant $C_l$ and express
      luminance in watts instead. The purpose of luminance is to match perceived
      brightness rather than actual emitted power. For example: A red light and
      a green light with equal luminance will appear equally bright, even though
      they may emit different amounts of physical power. This makes luminance an
      essential metric in color science, display technology, and lighting
      design, where human perception matters more than raw energy output. Now
      that we understand what luminance is, together with the chromaticity, we
      can fully describe a color! In the next section, we'll modify the
      trichromatic graph to take into account the luminance information of a
      color. The results are three functions called the
      <span class="highlight">Color Matching Functions</span>.
    </p>
    <h3>Color Matching Functions (CMF)</h3>
    <p>
      Remember the 2D graph representing the trichromatic coefficients? It
      allowed us to describe colors independently of luminance, but now, with
      our understanding of luminance, we can enhance this representation to
      fully account for both chromaticity and luminance. To achieve this, we
      introduce in this section three key functions known as the Color Matching
      Functions (CMFs).
    </p>
    <p>
      In the Color Matching Experiment, the goal was to match not only the
      chromaticity of a test color but also its luminance. This means that when
      mixing the primary lights, their combined luminance had to be equal to the
      luminance of the test color. When we write
    </p>
    <div class="block-equation">
      $$ C(\lambda) \triangleq
      r(\lambda)\mathcal{R}\hat{+}g(\lambda)\mathcal{G}\hat{+}b(\lambda)\mathcal{B}
      $$
    </div>
    <p>
      using the chromaticity coefficients \(r(\lambda),g(\lambda),b(\lambda)\) ,
      this equation only describes the relative amounts of chromaticity, but it
      tells us nothing about luminance. The resulting color C has an unknown
      luminance. We are now looking for an equation that will involve the color
      luminance. To determine the luminance of a color given by mixing three
      primaries, we use Grassmann's Law, which states that: The luminance of a
      color is the sum of the luminance of the individual lights that compose
      it. In other words, when mixing three primary lights, the total luminance
      of the result is simply the sum of their individual luminance. Let's pose
      \(L_r, L_g, L_b\) the luminance of each unit of primary
      \(\mathcal{R},\mathcal{G},\mathcal{B}\) respectively. Let's choose a
      specific spectral color C of wavelength \(\lambda_C\), whose chromaticity
      coefficients are \(r, g, b\). Mixing the primaries according to these
      chromaticity coefficients would result in a unknown luminance \(L_c\).
      Mathematically,
    </p>
    <div class="block-equation">
      $$ \begin{equation} L_c = rL_r+gL_g+bL_b \end{equation} $$
    </div>
    <p>
      Now let's decide that we want the luminance of a color C that emits one 1
      watt of light. We then have to scale the amount of each primary by the
      same factor $v$ to keep the chromaticity of the color.
    </p>
    <div class="block-equation">
      $$ \begin{equation} \begin{split} L_C^1=v(rL_r+gL_g+bL_b)\\
      =vrL_r+vgL_g+vbL_b\\ \end{split} \end{equation} $$
    </div>
    <p>
      This equation tells us that to match the color C with luminance of 1 watt,
      you need to mix \(vr\) amount of \(\mathcal{R}\), $vg$ of \(\mathcal{G}\)
      and $vb$ of \(\mathcal{B}\). So far, here are the unknowns : \(v, L_r,
      L_g, L_b\) We actually know the luminance \(L_C^1\). We said that it is
      the luminance given by 1 Watt of C. Remembering the luminance equation
    </p>
    <div class="block-equation">
      $$ L = C_l\int_\lambda \Phi(\lambda)V(\lambda) d\lambda $$
    </div>
    <p>
      If we omit the constant \(C_l\), \(V(\lambda)\) is the known photopic
      curve, and since for a monochromatic light $\lambda_C$ emitting 1 watt,
      its SPD \(\Phi(\lambda) = \delta(\lambda-\lambda_C)\) is just a peak at
      \(\lambda_C\), we can write
    </p>
    <div class="block-equation">$$ L_C^1 = V(\lambda_C) $$</div>
    Now we can isolate \(v\)
    <div class="block-equation">
      $$ \begin{equation} \begin{split} L_C^1 = V(\lambda_C) =
      v(rL_r+gL_g+bL_b)\\ v = \frac{V(\lambda_c)}{rL_r+gL_g+bL_b} \end{split}
      \end{equation} $$
    </div>
    <p>
      But what are the luminance of one unit of Red, Green, and Blue: \(L_r,
      L_g, L_b\)? Actually, we don't need the absolute luminance values, just
      their relative luminance is needed here. Here is what I mean. Without
      modifying the problem, we could have said that the factor $v$ could
      instead be written as \(v = k\frac{1}{L_r}\). Equation (3) becomes
    </p>
    <div class="block-equation">
      $$ \begin{split} k\frac{1}{L_r} = \frac{V(\lambda_c)}{rL_r+gL_g+bL_b}\\
      \end{split} $$
    </div>
    Now isolating $k$ gives $$
    <div class="block-equation">
      \begin{split} k = \frac{V(\lambda_c)}{\frac{1}{L_r}(rL_r+gL_g+bL_b)}\\
      =\frac{V(\lambda_c)}{(r\frac{L_r}{L_r}+g\frac{L_g}{L_r}+b\frac{L_b}{L_r})}\\
      = \frac{V(\lambda_c)}{(rL^r+gL^ g+bL^b)} \end{split} $$
    </div>
    with
    <div class="block-equation">
      $$ \begin{split} L^r = \frac{L_r}{L_r} = 1\\ L^g = \frac{L_g}{L_r}\\ L^b =
      \frac{L_b}{L_r}\\ \end{split} $$
    </div>
    <p>
      This change of variable illustrates that only the relative luminances are
      necessary. Those coefficients \(L^r, L^g, L^b\) are called the luminance
      coefficients. Injecting them in (2) gives this luminance equation
      involving the relative luminances.
    </p>
    <div class="block-equation">
      $$ \begin{equation} \begin{split} L_C^1=v(rL_r+gL_g+bL_b)\\ =
      k\frac{1}{L_r}(rL_r+gL_g+bL_b)\\ = krL^r + kgL_ g + kbL^b \end{split}
      \end{equation} $$
    </div>
    <p>
      But we are still missing \(L^g\) and \(L^b\) ! Wright measured that one
      unit of Green primary was about 4.4 times brighter than one unit of Red
      primary. And that one unit of blue primary was about 0.04 times less
      bright than one unit of Red. The exact value given by CIE are the
      following coefficients. If you are curious on how to find those
      coefficients, here is the <a href="TODO">procedure</a>.
    </p>
    <div class="block-equation">
      $$ L^r = 1 \\ L^g = 4.4036 \\ L^b = 0.0471 $$
    </div>
    Let's generalize equation (4) for any spectral color \(\lambda\),
    <div class="block-equation">
      $$ \begin{equation} \begin{aligned} L^1(\lambda)
      &=k(\lambda)r(\lambda)L^r+k(\lambda)g(\lambda)L^g+k(\lambda)b(\lambda)L^b
      \end{aligned} \end{equation} $$
    </div>
    <p>
      which tells us that to match the luminance of 1 watt of a color whose
      chromaticity coefficients are \(r(\lambda), g(\lambda), b(\lambda)\), you
      need
    </p>
    <ul>
      <li>\(\bar{r}(\lambda) = k(\lambda)r(\lambda)\) of Red Primary</li>
      <li>\(\bar{g}(\lambda) = k(\lambda)g(\lambda)\) of Green Primary</li>
      <li>\(\bar{b}(\lambda) = k(\lambda)b(\lambda)\) of Blue Primary</li>
    </ul>
    <p>
      Now you have it, the three Color Matching Functions \(\bar{r}(\lambda),
      \bar{g}(\lambda), \bar{b}(\lambda)\). To give a proper definition the CMF,
      \(\bar{r}(\lambda), \bar{g}(\lambda), \bar{b}(\lambda)\) represents the
      amount of Red, Green and Blue primary respectively, needed to match the
      spectral color \(C(\lambda)\) that emits 1 Watt of power. On the animation
      below, you can hover the color matching functions graph to see the
      mathematical relationship with the chromaticity coefficients and the
      photopic luminosity function \(V(\lambda)\).
    </p>
    <div id="anim-chrom2cmf"></div>
    <p>
      In the next section, we'll see how we can use those function to create any
      <span class="highlight">tristimulus values</span>, which are the three
      values used to describe any colors!
    </p>
    <h3>Tristimulus Values</h3>
    <p>
      Why are the CMF important? Remember at the beginning of this article, I
      suggested the idea that to create a color, we could just try to reproduce
      its SPD. I said that it was not realistic to take every monochromatic
      light with a different intensity to try to reproduce the SPD. But then we
      discovered the concept of metamerism. So actually only three monochromatic
      lights are needed to reproduce any colors. We just didn't know how to mix
      them together. Thanks to the CMF, now we know the amount of each primary
      required to match a specific SPD. To reproduce any color C (not just a
      spectral color) having a SPD \(\Phi(\lambda)\), the CMF tell us that we
      need those amount of primary:
    </p>
    <div class="block-equation">
      $$ R=\int{\Phi(\lambda)\bar{r}(\lambda)d\lambda} \\
      G=\int{\Phi(\lambda)\bar{g}(\lambda)d\lambda} \\
      B=\int{\Phi(\lambda)\bar{b}(\lambda)d\lambda} $$
    </div>
    Now, the color C characterized by SPD $\Phi(\lambda)$ is exactly matched in
    chromaticity and luminance by those amounts
    <div class="block-equation">
      $$ C \triangleq R\mathcal{R}\hat{+}G\mathcal{G}\hat{+}B\mathcal{B} $$
    </div>
    <p>
      $R, G, B$ are called the tristimulus values of C. The tristimulus R, G, B
      of a color C are the amount of Red, Green and Blue primary respectively
      required to match the color C in chromaticity and luminance. Note that the
      mix R, G, B does not reproduce the SPD of C. They create a light whose
      color is perceived the same as the one of SPD \(\Phi(\lambda)\). In the
      animation below, you can select a color using the dropdown menu. You will
      see how its SPD is multiplied by the CMF. The area under each resulting
      curve represents the tristimulus values.
    </p>
    <div id="anim-tristimulus-from-spd"></div>
    <p>
      With the tristimulus values, we have found a way to represent
      mathematically any color using three numbers. Remember that we said that a
      color is a specific cone response and that if we could find all the cone
      response, they would compose all the colors a human can perceive, i.e the
      Human Visual Gamut. The R, G, B tristimulus values are those cones
      response! It would be more correct to say that they are the attempt of
      Guild and Wright to represent the cone response. In an other chapter,
      we'll compare the real cone responses (L, M, S) found later by scientists
      to those tristimulus RGB. Since the tristimulus are 3 numbers, we can use
      them as dimensions on a 3D graph! Each axis will represent the amount of
      each primary. If you forgot what one unit of R primary is, it is the
      <i>look</i> of the Red Primary found during calibration! Our unit system
      is the one decided during calibration.
    </p>
    <h3>Graphical 3D representation of colors</h3>
    <p>
      Let's start to plot the tristimulus of the Spectral Colors corresponding
      of monochromatic lights that emit 1 one watt! Why? because we already have
      those tristimulus values, they are equivalent to the CMF! Remember that
      the CMF values are the amount of primary needed to match a monochromatic
      light emitting one watt. Mathematically, you could express the SPD of
      monochromatic light as dirac function \(\Phi(\lambda) =
      P_0\delta(\lambda-\lambda_0)\), with P0=1 watt. Therefore the tristimulus
      value of a monochromatic light of wavelength \(\lambda_m\) emitting 1 watt
      are given by
    </p>
    <div class="block-equation">
      $$
      R_m=\int{\delta(\lambda-\lambda_m)\bar{r}(\lambda)d\lambda}=\bar{r}(\lambda_m)\\
      G_m=\int{\delta(\lambda-\lambda_m)\bar{g}(\lambda)d\lambda}=\bar{g}(\lambda_m)
      \\
      B_m=\int{\delta(\lambda-\lambda_m)\bar{b}(\lambda)d\lambda}=\bar{b}(\lambda_m)
      $$
    </div>
    which mean that for each spectral color, we can take the value of the CMF as
    their tristimulus value. In the animation below, you can hover on each
    wavelength and see their corresponding tristimulus value on the 3d graph.
    <div id="anim-cmf2graph3d"></div>
    <p>
      Fine, now we have the spectral colors, but what about the other colors?
      Remember when we talked about polychromaticity? You can combine
      monochromatic light to create other colors? Then mathematically, we can
      also express it in this 3D graph. Let's take the color Red an Green. If
      you mix half of both, you do the same for their tristimulus value and you
      will have a resulting color C. Name it as you want (maybe yellow?). But
      what your brain will perceive is a linear combination of both of the
      spectral color. On the graph you notice that it almost coincide with the
      yellow spectral color. Yes! Metamerism! In your brain, the response of the
      cones will be similar as the response given by monochromatic yellow light!
      So mixing red and green will give you the same response. But wait R, G, B
      are not the brain response right? You're right, but remember, according to
      the research of Thomas, Guild and Wright thought that each cone was more
      sensitive to one primary color, so they use the primary as a way to
      simulate the cone response. And later, when we were able to effectively
      compute the cone response (we'll talk later about LMS), the 3D graph will
      look very similar!!
    </p>
    <p>
      So by combining the monochromatic light with different weights, we are
      able to make the brain perceive other colors and we can plot them in the
      3D graph. There is an infinity of combination possible, but some of them
      will give the same color! Taking two spectral colors and generating all
      the colors in between can already give us many colors, which as we can
      visualize on the animation, will give us an "envelope” of the Human Visual
      Gamut.
    </p>
    <div id="interpolate-tristimulus"></div>
  </body>
</html>
